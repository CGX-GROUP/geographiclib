# -*- Makefile -*-

# ssh -t karney,geographiclib@shell.sourceforge.net create
# git: /home/git/p/geographiclib/code.git
# web: /home/project-web/geographiclib
# files: /home/frs/project/geographiclib

USER=karney
STAGE=$(HOME)/web
WEBSTAGE=$(STAGE)/geographiclib-web
DATASTAGE=$(STAGE)/geographiclib-files
SCRIPTSTAGE=$(WEBSTAGE)/htdocs/scripts

distrib-doc:
	rsync --delete -av -e ssh $(WEBSTAGE)/htdocs $(USER),geographiclib@web.sourceforge.net:./

distrib-files:
	rsync -av --exclude .svn --exclude '.git*' --delete data-distrib/distrib-C++ $(DATASTAGE)/
	rsync --exclude '*~' --exclude '#*' --exclude '.#*' --exclude .svn --exclude '.git*' --delete --delete-excluded -av -e ssh $(DATASTAGE)/* $(USER)@frs.sourceforge.net:/home/frs/project/geographiclib/

distrib-cgi:
	for f in GeoConvert GeodSolve GeoidEval Planimeter RhumbSolve printlogs Geod; do \
	  a=cgi-bin/$$f.cgi; b=$(WEBSTAGE)/cgi-bin/$$f; \
	  install -C $$a $$b; done
	for f in utils; do \
	  a=cgi-bin/$$f.sh; b=$(WEBSTAGE)/cgi-bin/$$f.sh; \
	  install -C -m 644 $$a $$b; done
	rsync --exclude '*~' --exclude '#*' --exclude '.#*' --delete --delete-excluded -av -e ssh $(WEBSTAGE)/{cgi-bin,geoids} $(USER),geographiclib@web.sourceforge.net:./

TAGS:
	ls include/GeographicLib/*hpp src/*.cpp tools/*.cpp | xargs etags

.PHONY: distrib-html distrib-files distrib-cgi distrib-js distrib-python TAGS
